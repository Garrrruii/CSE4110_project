with A(shipment_code) as (select shipment_code from delivery where delivery_state='crash') select * from shipment, A where A.shipment_code=shipment.shipment_code and shipment_num='
with A(shipment_code) as (select shipment_code from delivery where delivery_state='crash') select customer.customer_name from ((ship_pack join shipment) join package) join customer, A where A.shipment_code=shipment.shipment_code and ship_pack.shipment_code=shipment.shipment_code and ship_pack.package_code=package.package_code and package.customer_ID=customer.customer_ID and shipment_num='
with A(shipment_code) as (select shipment_code from delivery where delivery_state='crash') select distinct receipt.recipient from ((shipment join ship_pack) join receipt), A where A.shipment_code=ship_pack.shipment_code and ship_pack.shipment_code=shipment.shipment_code and ship_pack.package_code=receipt.package_code and not receipt.recipient is null and shipment_num='
with A(shipment_code, delivery_time, warehouse_to, warehouse_from, delivery_state) as (select delivery.shipment_code, delivery_time, warehouse_to, warehouse_from, delivery_state from delivery join shipment where delivery.shipment_code=shipment.shipment_code and shipment.shipment_num='
') select * from A where delivery_state='arrive' and delivery_time < (select delivery_time from A where delivery_state='crash') and delivery_time >= all (select delivery_time from A where delivery_state='arrive')
with B(customer_ID, cnt) as(with A(customer_ID, package_code) as(select distinct package.customer_ID, package.package_code from package join (receipt join bill) where package.package_code=receipt.package_code and receipt.receipt_code=bill.receipt_code and bill.bill_issuetime like '
%') select customer_ID, count(package_code) as cnt from A group by customer_ID order by cnt desc) select customer.customer_name from B join customer where B.cnt >= (select max(cnt) from B) and B.customer_ID=customer.customer_ID
with B(customer_ID, billsum) as(with A(customer_ID, package_code, bill_amount) as(select distinct package.customer_ID, package.package_code,bill.bill_amount from package join (receipt join bill) where package.package_code=receipt.package_code and receipt.receipt_code=bill.receipt_code and bill.bill_issuetime like '
%') select customer_ID, sum(bill_amount) as billsum from A group by customer_ID order by billsum desc) select customer.customer_name from B, customer where B.billsum >= all(select billsum from B) and B.customer_ID=customer.customer_ID
with A(package_code, package_timeline) as (select package_code, package_timeline from package where package_timeline) select ship_pack.package_code from A, ship_pack join delivery where delivery.delivery_state='arrive' and delivery.warehouse_to='000000' and delivery.shipment_code=ship_pack.shipment_code and ship_pack.package_code=A.package_code and A.package_timeline < delivery.delivery_time
with B as (with A(package_code,customer_address) as(select package_code,customer.customer_address from package join customer where customer.customer_name='
' and customer.customer_ID=package.customer_ID) select customer_address, sum(bill.bill_amount) as billsum from  (receipt join bill), A where receipt.package_code=A.package_code and receipt.receipt_code=bill.receipt_code and bill.bill_issuetime like '
%') select * from B where not B.customer_address is null
with A(package_code) as (select package_code from package join customer where customer.customer_name='
' and customer.customer_ID=package.customer_ID) select A.package_code, receipt_type, package_detail, package_type, bill_amount, bill_payment, bill_issuetime, package_timeline from (receipt join bill), (A join package) where receipt.package_code=A.package_code and package.package_code=A.package_code and receipt.receipt_code=bill.receipt_code and bill.bill_issuetime like '
%' order by bill_issuetime
